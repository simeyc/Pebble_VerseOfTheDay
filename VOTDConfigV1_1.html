<!DOCTYPE html>
<html>
  <head>
    <title>Verse Of The Day Configuration</title>
  </head>
  <body bgcolor="#D8D8D8" style="font-family:verdana;text-align:center" onload="parseArgs()">
    <h1>VERSE OF THE DAY<br>
	<font size="5">Watchface Settings</font><br>
	<font size="3">--<font color="red"> NEW RELEASE AVAILABLE! PLEASE UPDATE! </font>--</font></h1>
 
    <p><b>Bible Language:</b>
    <select id="language_select" onchange="setupVersionCombo()">
      <option value="">Select Language...</option>
    </select>
    </p>
	
	<p><font size="2"><i>Note: Some languages may not be supported by Pebble.</i></font></p>

    <p><br><b>Bible Version:</b>
    <select id="version_select" style="width:300px">
      <option value="">Select Version...</option>
    </select>
    </p>
	
	<p><font size="2"><i>Note: Some versions are partial, i.e. they do not contain the whole Bible.</i></font></p>

    <p><br><b>Verse Refresh Time:</b>
    <select id="updateTimeHour_select">
      <option value=0>00</option>
      <option value=1>01</option>
      <option value=2>02</option>
      <option value=3>03</option>
      <option value=4>04</option>
      <option value=5>05</option>
      <option value=6>06</option>
      <option value=7>07</option>
      <option value=8>08</option>
      <option value=9>09</option>
      <option value=10>10</option>
      <option value=11>11</option>
      <option value=12>12</option>
      <option value=13>13</option>
      <option value=14>14</option>
      <option value=15>15</option>
      <option value=16>16</option>
      <option value=17>17</option>
      <option value=18>18</option>
      <option value=19>19</option>
      <option value=20>20</option>
      <option value=21>21</option>
      <option value=22>22</option>
      <option value=23>23</option>
    </select> :
    <select id="updateTimeMinute_select">
      <option value=0>00</option>
      <option value=5>05</option>
      <option value=10>10</option>
      <option value=15>15</option>
      <option value=20>20</option>
      <option value=25>25</option>
      <option value=30>30</option>
      <option value=35>35</option>
      <option value=40>40</option>
      <option value=45>45</option>
      <option value=50>50</option>
      <option value=55>55</option>
    </select>
    </p>

    <p><br><b>Enable light while verse shown:</b>
    <input type="checkbox" id="enableLight_checkbox">
    </p>

    <p><br><b>Vibrate on Bluetooth connect/disconnect:</b>
    <input type="checkbox" id="btVibe_checkbox">
    </p>
    <!--
    <p><br><b>Progress Bar Settings:-</b></p>

    <p><b>Day Start:</b>
    <select id="dayStartHour_select" onchange="setupDayStart()">
      <option value=0>00</option>
      <option value=1>01</option>
      <option value=2>02</option>
      <option value=3>03</option>
      <option value=4>04</option>
      <option value=5>05</option>
      <option value=6>06</option>
      <option value=7>07</option>
      <option value=8>08</option>
      <option value=9>09</option>
      <option value=10>10</option>
      <option value=11>11</option>
      <option value=12>12</option>
      <option value=13>13</option>
      <option value=14>14</option>
      <option value=15>15</option>
      <option value=16>16</option>
      <option value=17>17</option>
      <option value=18>18</option>
      <option value=19>19</option>
      <option value=20>20</option>
      <option value=21>21</option>
      <option value=22>22</option>
      <option value=23>23</option>
    </select> :
    <select id="dayStartMinute_select" onchange="setupDayStart()">
      <option value=0>00</option>
      <option value=5>05</option>
      <option value=10>10</option>
      <option value=15>15</option>
      <option value=20>20</option>
      <option value=25>25</option>
      <option value=30>30</option>
      <option value=35>35</option>
      <option value=40>40</option>
      <option value=45>45</option>
      <option value=50>50</option>
      <option value=55>55</option>
    </select>
    </p>

    <p><b>Day End:</b>
    <select id="dayEndHour_select" onchange="setupDayEnd()">
      <option value=0>00</option>
      <option value=1>01</option>
      <option value=2>02</option>
      <option value=3>03</option>
      <option value=4>04</option>
      <option value=5>05</option>
      <option value=6>06</option>
      <option value=7>07</option>
      <option value=8>08</option>
      <option value=9>09</option>
      <option value=10>10</option>
      <option value=11>11</option>
      <option value=12>12</option>
      <option value=13>13</option>
      <option value=14>14</option>
      <option value=15>15</option>
      <option value=16>16</option>
      <option value=17>17</option>
      <option value=18>18</option>
      <option value=19>19</option>
      <option value=20>20</option>
      <option value=21>21</option>
      <option value=22>22</option>
      <option value=23>23</option>
    </select> :
    <select id="dayEndMinute_select" onchange="setupDayEnd()">
      <option value=0>00</option>
      <option value=5>05</option>
      <option value=10>10</option>
      <option value=15>15</option>
      <option value=20>20</option>
      <option value=25>25</option>
      <option value=30>30</option>
      <option value=35>35</option>
      <option value=40>40</option>
      <option value=45>45</option>
      <option value=50>50</option>
      <option value=55>55</option>
    </select>
    </p>
    
	<p><font size="3">------------------------------------------</font></p>
    -->
	<p><br>
    <button type="submit" style="width:140px;height:36px" id="save_button"><font size="5"><b>Save</b></font></button>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button type="submit" style="width:140px;height:36px" id="cancel_button"><font size="5"><b>Cancel</b></font></button>
    </p>
  </body>
</html>

<script>
var versionTable = [
  { language:{value:"sq", text:"Albanian"},         versions:[{value:"alb",      text:"Albanian Bible"}] },
  { language:{value:"amu", text:"Amuzgo Guerrero"}, versions:[{value:"amu",      text:"Amuzgo de Guerrero"}] },
  { language:{value:"ar", text:"Arabic"},           versions:[{value:"erv-ar",   text:"Arabic Bible: Easy-to-Read Version"},
                                                              {value:"alab",     text:"Arabic Life Application Bible"}] },
  { language:{value:"awa", text:"Awadhi"},          versions:[{value:"erv-awa",  text:"Awadhi Bible: Easy-to-Read Version"}] },
  { language:{value:"bg", text:"Bulgarian"},        versions:[{value:"bg1940",   text:"1940 Bulgarian Bible"},
                                                              {value:"bulg",     text:"Bulgarian Bible"},
                                                              {value:"erv-bg",   text:"Bulgarian New Testament: Easy-to-Read Version"},
                                                              {value:"bpb",      text:"Bulgarian Protestant Bible"}] },
  { language:{value:"ceb", text:"Cebuano"},         versions:[{value:"apsd-ceb", text:"Ang Pulong Sa Dios"}] },
  { language:{value:"chr", text:"Cherokee"},        versions:[{value:"chr",      text:"Cherokee New Testament"}] },
  { language:{value:"cco", text:"Chinanteco"},      versions:[{value:"cco",      text:"Chinanteco de Comaltepec"}] },
  { language:{value:"zh", text:"Chinese"},          versions:[{value:"ccb",      text:"Chinese Contemporary Bible"},
                                                              {value:"erv-zh",   text:"Chinese New Testament: Easy-to-Read Version"},
                                                              {value:"cnvs",     text:"Chinese New Version (Simplified)"},
                                                              {value:"cnvt",     text:"Chinese New Version (Traditional)"},
                                                              {value:"csbs",     text:"Chinese Standard Bible (Simplified)"},
                                                              {value:"csbt",     text:"Chinese Standard Bible (Traditional)"},
                                                              {value:"cuvs",     text:"Chinese Union Version (Simplified)"},
                                                              {value:"cuv",      text:"Chinese Union Version (Traditional)"},
                                                              {value:"cuvmps",   text:"Chinese Union Version Modern Punctuation (Simplified)"},
                                                              {value:"cuvmpt",   text:"Chinese Union Version Modern Punctuation (Traditional)"}] },
  { language:{value:"hr", text:"Croatian"},         versions:[{value:"hnz-ri",   text:"Hrvatski Novi Zavjet – Rijeka 2001"},
                                                              {value:"cro",      text:"Knijga O Kristu"}] },
  { language:{value:"cs", text:"Czech"},            versions:[{value:"b21",      text:"Bible 21"},
                                                              {value:"snc",      text:"Slovo na cestu"}] },
  { language:{value:"da", text:"Danish"},           versions:[{value:"bph",      text:"Bibelen på hverdagsdansk"},
                                                              {value:"dn1933",   text:"Dette er Biblen på dansk"}] },
  { language:{value:"nl", text:"Dutch"},            versions:[{value:"htb",      text:"Het Boek"}] },
  { language:{value:"en", text:"English"},          versions:[{value:"asv",      text:"American Standard Version"},
                                                              {value:"amp",      text:"Amplified Bible"},
                                                              {value:"ceb",      text:"Common English Bible"},
                                                              {value:"cjb",      text:"Complete Jewish Bible"},
                                                              {value:"cev",      text:"Contemporary English Version"},
                                                              {value:"darby",    text:"Darby Translation"},
                                                              {value:"dlnt",     text:"Disciples’ Literal New Testament"},
                                                              {value:"dra",      text:"Douay-Rheims 1899 American Edition"},
                                                              {value:"erv",      text:"Easy-to-Read Version"},
                                                              {value:"esv",      text:"English Standard Version "},
                                                              {value:"esvuk",    text:"English Standard Version Anglicised"},
                                                              {value:"exb",      text:"Expanded Bible"},
                                                              {value:"gnv",      text:"1599 Geneva Bible"},
                                                              {value:"gw",       text:"GOD’S WORD Translation"},
                                                              {value:"gnt",      text:"Good News Translation"},
                                                              {value:"hcsb",     text:"Holman Christian Standard Bible"},
                                                              {value:"isv",      text:"International Standard Version"},
                                                              {value:"phillips", text:"J.B. Phillips New Testament"},
                                                              {value:"jub",      text:"Jubilee Bible 2000"},
                                                              {value:"kjv",      text:"King James Version"},
                                                              {value:"akjv",     text:"Authorized (King James) Version"},
                                                              {value:"kj21",     text:"21st Century King James Version"},
                                                              {value:"leb",      text:"Lexham English Bible"},
                                                              {value:"tlb",      text:"Living Bible"},
                                                              {value:"msg",      text:"The Message"},
                                                              {value:"mev",      text:"Modern English Version"},
                                                              {value:"mounce",   text:"Mounce Reverse-Interlinear New Testament"},
                                                              {value:"nog",      text:"Names of God Bible"},
                                                              {value:"nabre",    text:"New American Bible (Revised Edition)"},
                                                              {value:"nasb",     text:"New American Standard Bible"},
                                                              {value:"ncv",      text:"New Century Version"},
                                                              {value:"net",      text:"New English Translation"},
                                                              {value:"nirv",     text:"New International Reader's Version"},
                                                              {value:"niv",      text:"New International Version"},
                                                              {value:"nivuk",    text:"New International Version - UK"},
                                                              {value:"nkjv",     text:"New King James Version"},
                                                              {value:"nlv",      text:"New Life Version"},
                                                              {value:"nlt",      text:"New Living Translation"},
                                                              {value:"nrsv",     text:"New Revised Standard Version"},
                                                              {value:"nrsva",    text:"New Revised Standard Version, Anglicised"},
                                                              {value:"nrsvace",  text:"New Revised Standard Version, Anglicised Catholic Edition "},
                                                              {value:"nrsvce",   text:"New Revised Standard Version Catholic Edition"},
                                                              {value:"ojb",      text:"Orthodox Jewish Bible"},
                                                              {value:"rsv",      text:"Revised Standard Version"},
                                                              {value:"rsvce",    text:"Revised Standard Version Catholic Edition"},
                                                              {value:"voice",    text:"The Voice"},
                                                              {value:"web",      text:"World English Bible"},
                                                              {value:"we",       text:"Worldwide English (New Testament)"},
                                                              {value:"wyc",      text:"Wycliffe Bible"},
                                                              {value:"ylt",      text:"Young's Literal Translation"}] },
  { language:{value:"fi", text:"Finnish"},          versions:[{value:"r1933",    text:"Raamattu 1933/38"}] },
  { language:{value:"fr", text:"French"},           versions:[{value:"bds",      text:"La Bible du Semeur"},
                                                              {value:"lsg",      text:"Louis Segond"},
                                                              {value:"neg1979",  text:"Nouvelle Edition de Genève"},
                                                              {value:"sg21",     text:"Segond 21"}] },
  { language:{value:"de", text:"German"},           versions:[{value:"hof",      text:"Hoffnung für Alle"},
                                                              {value:"luth1545", text:"Luther Bibel 1545"},
                                                              {value:"ngu-de",   text:"Neue Genfer Übersetzung"},
                                                              {value:"sch1951",  text:"Segond 21"},
                                                              {value:"sch2000",  text:"Schlachter 1951"},
                                                              {value:"reimer",   text:"Schlachter 2000"}] },
  { language:{value:"grc", text:"Greek"},           versions:[{value:"tr1550",   text:"1550 Stephanus New Testament"},
                                                              {value:"whnu",     text:"1881 Westcott-Hort New Testament"},
                                                              {value:"tr1894",   text:"1894 Scrivener New Testament"},
                                                              {value:"sblgnt",   text:"SBL Greek New Testament"}] },
  { language:{value:"ht", text:"Haitian Creole"},   versions:[{value:"hcv",      text:"Haitian Creole Version"}] },
  { language:{value:"hwc", text:"Hawai'i Pidgin"},  versions:[{value:"hwp",      text:"Hawai‘i Pidgin"}] },
  { language:{value:"he", text:"Hebrew"},           versions:[{value:"hhh",      text:"Habrit Hakhadasha/Haderekh"}] },
  { language:{value:"hil", text:"Hiligaynon"},      versions:[{value:"hlgn",     text:"Ang Pulong Sang Dios"}] },
  { language:{value:"hi", text:"Hindi"},            versions:[{value:"erv-hi",   text:"Hindi Bible: Easy-to-Read Version"}] },
  { language:{value:"hu", text:"Hungarian"},        versions:[{value:"kar",      text:"Hungarian Károli"},
                                                              {value:"erv-hu",   text:"Hungarian Bible: Easy-to-Read Version"},
                                                              {value:"nt-hu",    text:"Hungarian New Translation"}] },
  { language:{value:"is", text:"Icelandic"},        versions:[{value:"iceland",  text:"Icelandic Bible"}] },
  { language:{value:"it", text:"Italian"},          versions:[{value:"bdg",      text:"La Bibbia della Gioia"},
                                                              {value:"cei",      text:"Conferenza Episcopale Italiana"},
                                                              {value:"lnd",      text:"La Nuova Diodati"},
                                                              {value:"nr1994",   text:"Nuova Riveduta 1994"},
                                                              {value:"nr2006",   text:"Nuova Riveduta 2006"}] },
  { language:{value:"jac", text:"Jacaltek"},        versions:[{value:"jac",      text:"Jacalteco, Oriental"}] },
  { language:{value:"ckw", text:"Kaqchikel"},       versions:[{value:"ckw",      text:"Cakchiquel Occidental"}] },
  { language:{value:"kek", text:"Kekchi"},          versions:[{value:"kek",      text:"Kekchi"}] },
  { language:{value:"qut", text:"K'iche'"},         versions:[{value:"qut",      text:"Quiché, Centro Occidental"}] },
  { language:{value:"la", text:"Latin"},            versions:[{value:"vulgate",  text:"Biblia Sacra Vulgata"}] },
  { language:{value:"mi", text:"Maori"},            versions:[{value:"maori",    text:"Maori Bible"}] },
  { language:{value:"mk", text:"Macedonian"},       versions:[{value:"mnt",      text:"Macedonian New Testament"}] },
  { language:{value:"mr", text:"Marathi"},          versions:[{value:"erv-mr",   text:"Marathi Bible: Easy-to-Read Version"}] },
  { language:{value:"mam", text:"Mam"},             versions:[{value:"mvc",      text:"Mam, Central"},
                                                              {value:"mvj",      text:"Mam de Todos Santos Chuchumatán"}] },
  { language:{value:"ngu", text:"Nahuatl"},         versions:[{value:"ngu",      text:"Náhuatl de Guerrero"}] },
  { language:{value:"ne", text:"Nepali"},           versions:[{value:"erv-ne",   text:"Nepali Bible: Easy-to-Read Version"}] },
  { language:{value:"no", text:"Norwegian"},        versions:[{value:"dnb1930",  text:"Det Norsk Bibelselskap 1930"},
                                                              {value:"lb",       text:"En Levende Bok"}] },
  { language:{value:"or", text:"Oriya"},            versions:[{value:"erv-or",   text:"Oriya Bible: Easy-to-Read Version"}] },
  { language:{value:"ppl", text:"Pipil"},           versions:[{value:"nbtn",     text:"Ne Bibliaj Tik Nawat"}] },
  { language:{value:"pl", text:"Polish"},           versions:[{value:"np",       text:"Nowe Przymierze"},
                                                              {value:"sz-pl",    text:"Słowo Życia"},
                                                              {value:"ubg",      text:"Updated Gdańsk Bible"}] },
  { language:{value:"pt", text:"Portuguese"},       versions:[{value:"arc",      text:"Almeida Revista e Corrigida 2009"},
                                                              {value:"ntlh",     text:"Nova Traduҫão na Linguagem de Hoje 2000"},
                                                              {value:"nvi-pt",   text:"Nova Versão Internacional"},
                                                              {value:"ol",       text:"O Livro"},
                                                              {value:"vfl",      text:"Portuguese New Testament: Easy-to-Read Version"}] },
  { language:{value:"pa", text:"Punjabi"},          versions:[{value:"erv-pa",   text:"Punjabi Bible: Easy-to-Read Version"}] },
  { language:{value:"qu", text:"Quichua"},          versions:[{value:"mtds",     text:"Mushuj Testamento Diospaj Shimi"}] },
  { language:{value:"ro", text:"Romanian"},         versions:[{value:"ntlr",     text:"Nouă Traducere În Limba Română"}] },
  { language:{value:"ru", text:"Russian"},          versions:[{value:"erv-ru",   text:"Russian New Testament: Easy-to-Read Version"},
                                                              {value:"rusv",     text:"Russian Synodal Version"},
                                                              {value:"sz",       text:"Slovo Zhizny"},
                                                              {value:"cars",     text:"Священное Писание (Восточный Перевод)"},
                                                              {value:"carst",    text:"Священное Писание (Восточный перевод), версия для Таджикистана"},
                                                              {value:"carsa",    text:"Священное Писание (Восточный перевод), версия с «Аллахом»"}] },
  { language:{value:"sr", text:"Serbian"},          versions:[{value:"erv-sr",   text:"Serbian New Testament: Easy-to-Read Version"}] },
  { language:{value:"sk", text:"Slovak"},           versions:[{value:"npk",      text:"Nádej pre kazdého"}] },
  { language:{value:"so", text:"Somali"},           versions:[{value:"som",      text:"Somali Bible"}] },
  { language:{value:"es", text:"Spanish"},          versions:[{value:"lbla",     text:"La Biblia de las Américas"},
                                                              {value:"dhh",      text:"Dios Habla Hoy"},
                                                              {value:"jbs",      text:"Jubilee Bible 2000 (Spanish)"},
                                                              {value:"nbd",      text:"Nueva Biblia al Día"},
                                                              {value:"nblh",     text:"Nueva Biblia Latinoamericana de Hoy"},
                                                              {value:"ntv",      text:"Nueva Traducción Viviente"},
                                                              {value:"cst",      text:"Nueva Versión Internacional (Castilian)"},
                                                              {value:"nvi",      text:"Nueva Versión Internacional"},
                                                              {value:"pdt",      text:"Palabra de Dios para Todos"},
                                                              {value:"blp",      text:"La Palabra (España)"},
                                                              {value:"blph",     text:"La Palabra (Hispanoamérica)"},
                                                              {value:"rvc",      text:"Reina Valera Contemporánea"},
                                                              {value:"rvr1960",  text:"Reina-Valera 1960"},
                                                              {value:"rvr1977",  text:"Reina Valera 1977"},
                                                              {value:"rvr1995",  text:"Reina-Valera 1995"},
                                                              {value:"rva",      text:"Reina-Valera Antigua"},
                                                              {value:"tla",      text:"Traducción en lenguaje actual"}] },
  { language:{value:"sw", text:"Swahili"},          versions:[{value:"snt",      text:"Neno: Bibilia Takatifu"}] },
  { language:{value:"sv", text:"Swedish"},          versions:[{value:"svl",      text:"Nya Levande Bibeln"},
                                                              {value:"sv1917",   text:"Svenska 1917"},
                                                              {value:"sfb",      text:"Svenska Folkbibeln"}] },
  { language:{value:"tl", text:"Tagalog"},          versions:[{value:"snd",      text:"Ang Salita ng Diyos"}] },
  { language:{value:"ta", text:"Tamil"},            versions:[{value:"erv-ta",   text:"Tamil Bible: Easy-to-Read Version"}] },
  { language:{value:"th", text:"Thai"},             versions:[{value:"tncv",     text:"Thai New Contemporary Bible"},
                                                              {value:"erv-th",   text:"Thai New Testament: Easy-to-Read Version"}] },
  { language:{value:"twi", text:"Twi"},             versions:[{value:"na-twi",   text:"Nkwa Asem"}] },
  { language:{value:"uk", text:"Ukranian"},         versions:[{value:"ukr",      text:"Ukrainian Bible"},
                                                              {value:"erv-uk",   text:"Ukrainian New Testament: Easy-to-Read Version"}] },
  { language:{value:"ur", text:"Urdu"},             versions:[{value:"erv-ur",   text:"Urdu Bible: Easy-to-Read Version"}] },
  { language:{value:"usp", text:"Uspanteko"},       versions:[{value:"usp",      text:"Uspanteco"}] },
  { language:{value:"vi", text:"Vietnamese"},       versions:[{value:"viet",     text:"1934 Vietnamese Bible"},
                                                              {value:"bd2011",   text:"Bản Dịch 2011"},
                                                              {value:"bpt",      text:"Vietnamese Bible: Easy-to-Read Version"}] }
  ];

function parseArgs()
{
  var versionString, updateTime, enableLight, btVibe;
  var args = location.search.substr(1).split("&");

  for (var i = 0; i<args.length; i++)
  {
      var temp = args[i].split("=");

      if (temp[0] === "versionString")
        versionString = decodeURIComponent(temp[1]);
      else if (temp[0] === "updateTime")
        updateTime = decodeURIComponent(temp[1]);
      else if (temp[0] === "enableLight")
        enableLight = decodeURIComponent(temp[1]);
      else if (temp[0] === "btVibe")
        btVibe = decodeURIComponent(temp[1]);
  }

  initInputs(versionString, updateTime, enableLight, btVibe);
}

function initInputs(versionString, updateTime, enableLight, btVibe)
{
  var languageCombo = document.getElementById("language_select");
  var versionCombo = document.getElementById("version_select");
  var updateTimeHourCombo = document.getElementById("updateTimeHour_select");
  var updateTimeMinuteCombo = document.getElementById("updateTimeMinute_select");
  var enableLightCheckbox = document.getElementById("enableLight_checkbox");
  var btVibeCheckbox = document.getElementById("btVibe_checkbox");
  
  for (var i=0; i<versionTable.length; i++)
  {
    // add option to languageCombo
    addOptionToCombo(languageCombo, versionTable[i].language);

    for (var j=0; j<versionTable[i].versions.length; j++)
    {
      if (versionTable[i].versions[j].value === versionString)
      {
        for (var k=0; k<versionTable[i].versions.length; k++)
          addOptionToCombo(versionCombo, versionTable[i].versions[k]);

        versionCombo.options[j+1].selected = 'selected';
        languageCombo.options[i+1].selected = 'selected';
      }
    }
  }

  var updateTimeVals = translateTimeSetting(updateTime);
  selectComboOption(updateTimeHourCombo, updateTimeVals.hour.toString());
  selectComboOption(updateTimeMinuteCombo, updateTimeVals.minute.toString());

  enableLightCheckbox.checked = (enableLight === 'true');
  btVibeCheckbox.checked = (btVibe === 'true');
}

function selectComboOption(combo, optionValue)
{
  for (var i=0; i<combo.options.length; i++)
  {
    if (combo.options[i].value === optionValue)
      combo.options[i].selected = 'selected';
  }
}

function translateTimeSetting(timeSetting)
{
  var hourVal = Math.floor(timeSetting/60);
  var minuteVal = timeSetting % 60;

  return {hour:hourVal, minute:minuteVal};
}

function setupVersionCombo()
{
  var languageCombo = document.getElementById("language_select");
  var versionCombo = document.getElementById("version_select");
  var language = languageCombo.options[languageCombo.selectedIndex].value;    
  var options = [];
  
  for (var i=0; i<versionTable.length; i++)
  {
    if (versionTable[i].language.value === language)
      options = versionTable[i].versions;
  }
  
  // refresh versionCombo with new options
  for (var j=0, k=1; j<options.length; j++, k++)
  {
    if (k < versionCombo.options.length)
    {
      versionCombo.options[k].value = options[j].value;
      versionCombo.options[k].text = options[j].text;
    }  
    else
      addOptionToCombo(versionCombo, options[j]);
  }

  // remove old options
  for (var l=(versionCombo.options.length-1); l>options.length; l--)
    versionCombo.options.remove(l);

  if (versionCombo.options.length < 3)
    versionCombo.options[1].selected = 'selected';
  else
    versionCombo.options[0].selected = 'selected';
}

function addOptionToCombo(combo, option)
{
  var opt = document.createElement("option");
  opt.value = option.value;
  opt.text = option.text;

  try { combo.add(opt, null); }
  catch(error) { combo.add(opt); }
}

function getVersionString() {
  var versionCombo = document.getElementById("version_select");
  return versionCombo.options[versionCombo.selectedIndex].value;
}

function calcTimeSetting(hourSelect, minuteSelect)
{
  var hourCombo = document.getElementById(hourSelect);
  var minuteCombo = document.getElementById(minuteSelect);

  var hour = hourCombo.options[hourCombo.selectedIndex].value;
  var minute = minuteCombo.options[minuteCombo.selectedIndex].value;

  return (hour*60 + minute*1);
}

function getEnableLight() {
  return document.getElementById("enableLight_checkbox").checked;
}

function getBtVibe() {
  return document.getElementById("btVibe_checkbox").checked;
}
/*
function getDayStart() {
  return calcTimeSetting("dayStartHour_select", "dayStartMinute_select");
}

function getDayEnd() {
  return calcTimeSetting("dayEndHour_select", "dayEndMinute_select");
}
*/
function getUpdateTime() {
  return calcTimeSetting("updateTimeHour_select", "updateTimeMinute_select");
}

var submitButton = document.getElementById("save_button");
submitButton.addEventListener("click", 
  function() {
    console.log("Settings Page: Submit");
    var options = {
      "versionString": getVersionString(),
      //"dayStart": getDayStart(),
      //"dayEnd": getDayEnd(),
      "updateTime": getUpdateTime(),
      "enableLight": getEnableLight(),
      "btVibe": getBtVibe()
    };
    var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(options));
    window.location.href = location;
  }, 
  false);

var cancelButton = document.getElementById("cancel_button");
cancelButton.addEventListener("click", 
  function() {
    console.log("Settings Page: Cancel");
    var location = "pebblejs://close";
    window.location.href = location;
  }, 
  false);
</script>
