<!DOCTYPE html>
<html>
  <head>
    <title>Verse Of The Day Configuration</title>
  </head>
  <body bgcolor="#D8D8D8" style="font-family:verdana;text-align:center" onload="parseArgs()">
    <h1>VERSE OF THE DAY<br>
	<font size="5">Watchface Settings</font><br>
	<font size="3">------------------------------------------</font></h1>
 
    <p><b>VOTD Language:</b>
    <select id="language_select" onchange="setupVersionCombo()">
      <option value="">Select Language...</option>
    </select>
    </p>
	
	<p><font size="2"><i>Some languages may not be supported by Pebble.</i></font></p>

    <p><br><b>VOTD Bible Version:</b>
    <select id="version_select" style="width:300px">
      <option value="">Select Version...</option>
    </select>
    </p>
	
	<p><font size="2"><i>Some versions are partial, i.e. they do not contain the whole Bible.</i></font></p>
	
    <p><br><b>Show Favourite Verse:</b>
    <input type="checkbox" id="favVerseEnable_checkbox">
	</p>
	
	<p><font size="2"><i>If checked, Favourite Verse will be shown instead of Verse Of The Day.</i></font></p>

	<p><br><b>Favourite Verse:</b>
    <select id="favVerseBook_select">
      <option value="">Select Book...</option>
    </select>
	<input type="text" id="favVerseChapter_input" style="width:23px"/>
	<font size="3"><b>:</b></font>
	<input type="text" id="favVerseVerse_input" style="width:47px"/>
    </p>
	
	<p><font size="2"><i>Favourite Verse is taken from ESV version. Verse ranges are valid, e.g. "1-3".</i></font></p>

    <p><br><b>Date Format:</b>
    <select id="dateFormat_select">
      <option value="">Select Format...</option>
    </select>
    </p>
	
    <p><br><b>Verse Font Size:</b>
    <select id="verseFont_select">
      <option value=0>Small</option>
      <option value=1>Medium</option>
      <option value=2>Large</option>
      <option value=3>Extra Large</option>
    </select>
    </p>
	
    <p><br><b>Verse Scroll Speed:</b>
    <select id="scrollSpeed_select">
      <option value=0>Slow</option>
      <option value=1>Medium</option>
      <option value=2>Fast</option>
    </select>
    </p>
	
    <p><br><b>Verse Refresh Time:</b>
    <select id="updateTimeHour_select">
      <option value=0>00</option>
      <option value=1>01</option>
      <option value=2>02</option>
      <option value=3>03</option>
      <option value=4>04</option>
      <option value=5>05</option>
      <option value=6>06</option>
      <option value=7>07</option>
      <option value=8>08</option>
      <option value=9>09</option>
      <option value=10>10</option>
      <option value=11>11</option>
      <option value=12>12</option>
      <option value=13>13</option>
      <option value=14>14</option>
      <option value=15>15</option>
      <option value=16>16</option>
      <option value=17>17</option>
      <option value=18>18</option>
      <option value=19>19</option>
      <option value=20>20</option>
      <option value=21>21</option>
      <option value=22>22</option>
      <option value=23>23</option>
    </select> :
    <select id="updateTimeMinute_select">
      <option value=0>00</option>
      <option value=5>05</option>
      <option value=10>10</option>
      <option value=15>15</option>
      <option value=20>20</option>
      <option value=25>25</option>
      <option value=30>30</option>
      <option value=35>35</option>
      <option value=40>40</option>
      <option value=45>45</option>
      <option value=50>50</option>
      <option value=55>55</option>
    </select>
    </p>

    <p><br><b>Enable light while verse shown:</b>
    <input type="checkbox" id="enableLight_checkbox">
    </p>

    <p><br><b>Vibrate on Bluetooth connect/disconnect:</b>
    <input type="checkbox" id="btVibe_checkbox">
    </p>

    <p><br><b>Show am/pm (12h display only):</b>
    <input type="checkbox" id="showAmPm_checkbox">
    </p>

    <p><br><b>Invert colours:</b>
    <input type="checkbox" id="invertColours_checkbox">
    </p>
	
	<p><br>
    <button type="submit" style="width:140px;height:36px" id="save_button"><font size="5"><b>Save</b></font></button>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button type="submit" style="width:140px;height:36px" id="cancel_button"><font size="5"><b>Cancel</b></font></button>
    </p>
  </body>
</html>

<script>
var versionTable = [
  { language:{value:"sq", text:"Albanian"},         versions:[{value:"alb",      text:"Albanian Bible"}] },
  { language:{value:"amu", text:"Amuzgo Guerrero"}, versions:[{value:"amu",      text:"Amuzgo de Guerrero"}] },
  { language:{value:"ar", text:"Arabic"},           versions:[{value:"erv-ar",   text:"Arabic Bible: Easy-to-Read Version"},
                                                              {value:"alab",     text:"Arabic Life Application Bible"}] },
  { language:{value:"awa", text:"Awadhi"},          versions:[{value:"erv-awa",  text:"Awadhi Bible: Easy-to-Read Version"}] },
  { language:{value:"bg", text:"Bulgarian"},        versions:[{value:"bg1940",   text:"1940 Bulgarian Bible"},
                                                              {value:"bulg",     text:"Bulgarian Bible"},
                                                              {value:"erv-bg",   text:"Bulgarian New Testament: Easy-to-Read Version"},
                                                              {value:"bpb",      text:"Bulgarian Protestant Bible"}] },
  { language:{value:"ceb", text:"Cebuano"},         versions:[{value:"apsd-ceb", text:"Ang Pulong Sa Dios"}] },
  { language:{value:"chr", text:"Cherokee"},        versions:[{value:"chr",      text:"Cherokee New Testament"}] },
  { language:{value:"cco", text:"Chinanteco"},      versions:[{value:"cco",      text:"Chinanteco de Comaltepec"}] },
  { language:{value:"zh", text:"Chinese"},          versions:[{value:"ccb",      text:"Chinese Contemporary Bible"},
                                                              {value:"erv-zh",   text:"Chinese New Testament: Easy-to-Read Version"},
                                                              {value:"cnvs",     text:"Chinese New Version (Simplified)"},
                                                              {value:"cnvt",     text:"Chinese New Version (Traditional)"},
                                                              {value:"csbs",     text:"Chinese Standard Bible (Simplified)"},
                                                              {value:"csbt",     text:"Chinese Standard Bible (Traditional)"},
                                                              {value:"cuvs",     text:"Chinese Union Version (Simplified)"},
                                                              {value:"cuv",      text:"Chinese Union Version (Traditional)"},
                                                              {value:"cuvmps",   text:"Chinese Union Version Modern Punctuation (Simplified)"},
                                                              {value:"cuvmpt",   text:"Chinese Union Version Modern Punctuation (Traditional)"}] },
  { language:{value:"hr", text:"Croatian"},         versions:[{value:"hnz-ri",   text:"Hrvatski Novi Zavjet – Rijeka 2001"},
                                                              {value:"cro",      text:"Knijga O Kristu"}] },
  { language:{value:"cs", text:"Czech"},            versions:[{value:"b21",      text:"Bible 21"},
                                                              {value:"snc",      text:"Slovo na cestu"}] },
  { language:{value:"da", text:"Danish"},           versions:[{value:"bph",      text:"Bibelen på hverdagsdansk"},
                                                              {value:"dn1933",   text:"Dette er Biblen på dansk"}] },
  { language:{value:"nl", text:"Dutch"},            versions:[{value:"htb",      text:"Het Boek"}] },
  { language:{value:"en", text:"English"},          versions:[{value:"asv",      text:"American Standard Version"},
                                                              {value:"amp",      text:"Amplified Bible"},
                                                              {value:"ceb",      text:"Common English Bible"},
                                                              {value:"cjb",      text:"Complete Jewish Bible"},
                                                              {value:"cev",      text:"Contemporary English Version"},
                                                              {value:"darby",    text:"Darby Translation"},
                                                              {value:"dlnt",     text:"Disciples’ Literal New Testament"},
                                                              {value:"dra",      text:"Douay-Rheims 1899 American Edition"},
                                                              {value:"erv",      text:"Easy-to-Read Version"},
                                                              {value:"esv",      text:"English Standard Version "},
                                                              {value:"esvuk",    text:"English Standard Version Anglicised"},
                                                              {value:"exb",      text:"Expanded Bible"},
                                                              {value:"gnv",      text:"1599 Geneva Bible"},
                                                              {value:"gw",       text:"GOD’S WORD Translation"},
                                                              {value:"gnt",      text:"Good News Translation"},
                                                              {value:"hcsb",     text:"Holman Christian Standard Bible"},
                                                              {value:"isv",      text:"International Standard Version"},
                                                              {value:"phillips", text:"J.B. Phillips New Testament"},
                                                              {value:"jub",      text:"Jubilee Bible 2000"},
                                                              {value:"kjv",      text:"King James Version"},
                                                              {value:"akjv",     text:"Authorized (King James) Version"},
                                                              {value:"kj21",     text:"21st Century King James Version"},
                                                              {value:"leb",      text:"Lexham English Bible"},
                                                              {value:"tlb",      text:"Living Bible"},
                                                              {value:"msg",      text:"The Message"},
                                                              {value:"mev",      text:"Modern English Version"},
                                                              {value:"mounce",   text:"Mounce Reverse-Interlinear New Testament"},
                                                              {value:"nog",      text:"Names of God Bible"},
                                                              {value:"nabre",    text:"New American Bible (Revised Edition)"},
                                                              {value:"nasb",     text:"New American Standard Bible"},
                                                              {value:"ncv",      text:"New Century Version"},
                                                              {value:"net",      text:"New English Translation"},
                                                              {value:"nirv",     text:"New International Reader's Version"},
                                                              {value:"niv",      text:"New International Version"},
                                                              {value:"nivuk",    text:"New International Version - UK"},
                                                              {value:"nkjv",     text:"New King James Version"},
                                                              {value:"nlv",      text:"New Life Version"},
                                                              {value:"nlt",      text:"New Living Translation"},
                                                              {value:"nrsv",     text:"New Revised Standard Version"},
                                                              {value:"nrsva",    text:"New Revised Standard Version, Anglicised"},
                                                              {value:"nrsvace",  text:"New Revised Standard Version, Anglicised Catholic Edition "},
                                                              {value:"nrsvce",   text:"New Revised Standard Version Catholic Edition"},
                                                              {value:"ojb",      text:"Orthodox Jewish Bible"},
                                                              {value:"rsv",      text:"Revised Standard Version"},
                                                              {value:"rsvce",    text:"Revised Standard Version Catholic Edition"},
                                                              {value:"voice",    text:"The Voice"},
                                                              {value:"web",      text:"World English Bible"},
                                                              {value:"we",       text:"Worldwide English (New Testament)"},
                                                              {value:"wyc",      text:"Wycliffe Bible"},
                                                              {value:"ylt",      text:"Young's Literal Translation"}] },
  { language:{value:"fi", text:"Finnish"},          versions:[{value:"r1933",    text:"Raamattu 1933/38"}] },
  { language:{value:"fr", text:"French"},           versions:[{value:"bds",      text:"La Bible du Semeur"},
                                                              {value:"lsg",      text:"Louis Segond"},
                                                              {value:"neg1979",  text:"Nouvelle Edition de Genève"},
                                                              {value:"sg21",     text:"Segond 21"}] },
  { language:{value:"de", text:"German"},           versions:[{value:"hof",      text:"Hoffnung für Alle"},
                                                              {value:"luth1545", text:"Luther Bibel 1545"},
                                                              {value:"ngu-de",   text:"Neue Genfer Übersetzung"},
                                                              {value:"sch1951",  text:"Segond 21"},
                                                              {value:"sch2000",  text:"Schlachter 1951"},
                                                              {value:"reimer",   text:"Schlachter 2000"}] },
  { language:{value:"grc", text:"Greek"},           versions:[{value:"tr1550",   text:"1550 Stephanus New Testament"},
                                                              {value:"whnu",     text:"1881 Westcott-Hort New Testament"},
                                                              {value:"tr1894",   text:"1894 Scrivener New Testament"},
                                                              {value:"sblgnt",   text:"SBL Greek New Testament"}] },
  { language:{value:"ht", text:"Haitian Creole"},   versions:[{value:"hcv",      text:"Haitian Creole Version"}] },
  { language:{value:"hwc", text:"Hawai'i Pidgin"},  versions:[{value:"hwp",      text:"Hawai‘i Pidgin"}] },
  { language:{value:"he", text:"Hebrew"},           versions:[{value:"hhh",      text:"Habrit Hakhadasha/Haderekh"}] },
  { language:{value:"hil", text:"Hiligaynon"},      versions:[{value:"hlgn",     text:"Ang Pulong Sang Dios"}] },
  { language:{value:"hi", text:"Hindi"},            versions:[{value:"erv-hi",   text:"Hindi Bible: Easy-to-Read Version"}] },
  { language:{value:"hu", text:"Hungarian"},        versions:[{value:"kar",      text:"Hungarian Károli"},
                                                              {value:"erv-hu",   text:"Hungarian Bible: Easy-to-Read Version"},
                                                              {value:"nt-hu",    text:"Hungarian New Translation"}] },
  { language:{value:"is", text:"Icelandic"},        versions:[{value:"iceland",  text:"Icelandic Bible"}] },
  { language:{value:"it", text:"Italian"},          versions:[{value:"bdg",      text:"La Bibbia della Gioia"},
                                                              {value:"cei",      text:"Conferenza Episcopale Italiana"},
                                                              {value:"lnd",      text:"La Nuova Diodati"},
                                                              {value:"nr1994",   text:"Nuova Riveduta 1994"},
                                                              {value:"nr2006",   text:"Nuova Riveduta 2006"}] },
  { language:{value:"jac", text:"Jacaltek"},        versions:[{value:"jac",      text:"Jacalteco, Oriental"}] },
  { language:{value:"ckw", text:"Kaqchikel"},       versions:[{value:"ckw",      text:"Cakchiquel Occidental"}] },
  { language:{value:"kek", text:"Kekchi"},          versions:[{value:"kek",      text:"Kekchi"}] },
  { language:{value:"qut", text:"K'iche'"},         versions:[{value:"qut",      text:"Quiché, Centro Occidental"}] },
  { language:{value:"la", text:"Latin"},            versions:[{value:"vulgate",  text:"Biblia Sacra Vulgata"}] },
  { language:{value:"mi", text:"Maori"},            versions:[{value:"maori",    text:"Maori Bible"}] },
  { language:{value:"mk", text:"Macedonian"},       versions:[{value:"mnt",      text:"Macedonian New Testament"}] },
  { language:{value:"mr", text:"Marathi"},          versions:[{value:"erv-mr",   text:"Marathi Bible: Easy-to-Read Version"}] },
  { language:{value:"mam", text:"Mam"},             versions:[{value:"mvc",      text:"Mam, Central"},
                                                              {value:"mvj",      text:"Mam de Todos Santos Chuchumatán"}] },
  { language:{value:"ngu", text:"Nahuatl"},         versions:[{value:"ngu",      text:"Náhuatl de Guerrero"}] },
  { language:{value:"ne", text:"Nepali"},           versions:[{value:"erv-ne",   text:"Nepali Bible: Easy-to-Read Version"}] },
  { language:{value:"no", text:"Norwegian"},        versions:[{value:"dnb1930",  text:"Det Norsk Bibelselskap 1930"},
                                                              {value:"lb",       text:"En Levende Bok"}] },
  { language:{value:"or", text:"Oriya"},            versions:[{value:"erv-or",   text:"Oriya Bible: Easy-to-Read Version"}] },
  { language:{value:"ppl", text:"Pipil"},           versions:[{value:"nbtn",     text:"Ne Bibliaj Tik Nawat"}] },
  { language:{value:"pl", text:"Polish"},           versions:[{value:"np",       text:"Nowe Przymierze"},
                                                              {value:"sz-pl",    text:"Słowo Życia"},
                                                              {value:"ubg",      text:"Updated Gdańsk Bible"}] },
  { language:{value:"pt", text:"Portuguese"},       versions:[{value:"arc",      text:"Almeida Revista e Corrigida 2009"},
                                                              {value:"ntlh",     text:"Nova Traduҫão na Linguagem de Hoje 2000"},
                                                              {value:"nvi-pt",   text:"Nova Versão Internacional"},
                                                              {value:"ol",       text:"O Livro"},
                                                              {value:"vfl",      text:"Portuguese New Testament: Easy-to-Read Version"}] },
  { language:{value:"pa", text:"Punjabi"},          versions:[{value:"erv-pa",   text:"Punjabi Bible: Easy-to-Read Version"}] },
  { language:{value:"qu", text:"Quichua"},          versions:[{value:"mtds",     text:"Mushuj Testamento Diospaj Shimi"}] },
  { language:{value:"ro", text:"Romanian"},         versions:[{value:"ntlr",     text:"Nouă Traducere În Limba Română"}] },
  { language:{value:"ru", text:"Russian"},          versions:[{value:"erv-ru",   text:"Russian New Testament: Easy-to-Read Version"},
                                                              {value:"rusv",     text:"Russian Synodal Version"},
                                                              {value:"sz",       text:"Slovo Zhizny"},
                                                              {value:"cars",     text:"Священное Писание (Восточный Перевод)"},
                                                              {value:"carst",    text:"Священное Писание (Восточный перевод), версия для Таджикистана"},
                                                              {value:"carsa",    text:"Священное Писание (Восточный перевод), версия с «Аллахом»"}] },
  { language:{value:"sr", text:"Serbian"},          versions:[{value:"erv-sr",   text:"Serbian New Testament: Easy-to-Read Version"}] },
  { language:{value:"sk", text:"Slovak"},           versions:[{value:"npk",      text:"Nádej pre kazdého"}] },
  { language:{value:"so", text:"Somali"},           versions:[{value:"som",      text:"Somali Bible"}] },
  { language:{value:"es", text:"Spanish"},          versions:[{value:"lbla",     text:"La Biblia de las Américas"},
                                                              {value:"dhh",      text:"Dios Habla Hoy"},
                                                              {value:"jbs",      text:"Jubilee Bible 2000 (Spanish)"},
                                                              {value:"nbd",      text:"Nueva Biblia al Día"},
                                                              {value:"nblh",     text:"Nueva Biblia Latinoamericana de Hoy"},
                                                              {value:"ntv",      text:"Nueva Traducción Viviente"},
                                                              {value:"cst",      text:"Nueva Versión Internacional (Castilian)"},
                                                              {value:"nvi",      text:"Nueva Versión Internacional"},
                                                              {value:"pdt",      text:"Palabra de Dios para Todos"},
                                                              {value:"blp",      text:"La Palabra (España)"},
                                                              {value:"blph",     text:"La Palabra (Hispanoamérica)"},
                                                              {value:"rvc",      text:"Reina Valera Contemporánea"},
                                                              {value:"rvr1960",  text:"Reina-Valera 1960"},
                                                              {value:"rvr1977",  text:"Reina Valera 1977"},
                                                              {value:"rvr1995",  text:"Reina-Valera 1995"},
                                                              {value:"rva",      text:"Reina-Valera Antigua"},
                                                              {value:"tla",      text:"Traducción en lenguaje actual"}] },
  { language:{value:"sw", text:"Swahili"},          versions:[{value:"snt",      text:"Neno: Bibilia Takatifu"}] },
  { language:{value:"sv", text:"Swedish"},          versions:[{value:"svl",      text:"Nya Levande Bibeln"},
                                                              {value:"sv1917",   text:"Svenska 1917"},
                                                              {value:"sfb",      text:"Svenska Folkbibeln"}] },
  { language:{value:"tl", text:"Tagalog"},          versions:[{value:"snd",      text:"Ang Salita ng Diyos"}] },
  { language:{value:"ta", text:"Tamil"},            versions:[{value:"erv-ta",   text:"Tamil Bible: Easy-to-Read Version"}] },
  { language:{value:"th", text:"Thai"},             versions:[{value:"tncv",     text:"Thai New Contemporary Bible"},
                                                              {value:"erv-th",   text:"Thai New Testament: Easy-to-Read Version"}] },
  { language:{value:"twi", text:"Twi"},             versions:[{value:"na-twi",   text:"Nkwa Asem"}] },
  { language:{value:"uk", text:"Ukranian"},         versions:[{value:"ukr",      text:"Ukrainian Bible"},
                                                              {value:"erv-uk",   text:"Ukrainian New Testament: Easy-to-Read Version"}] },
  { language:{value:"ur", text:"Urdu"},             versions:[{value:"erv-ur",   text:"Urdu Bible: Easy-to-Read Version"}] },
  { language:{value:"usp", text:"Uspanteko"},       versions:[{value:"usp",      text:"Uspanteco"}] },
  { language:{value:"vi", text:"Vietnamese"},       versions:[{value:"viet",     text:"1934 Vietnamese Bible"},
                                                              {value:"bd2011",   text:"Bản Dịch 2011"},
                                                              {value:"bpt",      text:"Vietnamese Bible: Easy-to-Read Version"}] }
  ];
  
var bookTable = [
  { value:"gen", text:"Genesis" },
  { value:"exo", text:"Exodus" },
  { value:"lev", text:"Leviticus" },
  { value:"num", text:"Numbers" },
  { value:"deu", text:"Deuteronomy" },
  { value:"jos", text:"Joshua" },
  { value:"jud", text:"Judges" },
  { value:"rut", text:"Ruth" },
  { value:"1sa", text:"1 Samuel" },
  { value:"2sa", text:"2 Samuel" },
  { value:"1ki", text:"1 Kings" },
  { value:"2ki", text:"2 Kings" },
  { value:"1ch", text:"1 Chronicles" },
  { value:"2ch", text:"2 Chronicles" },
  { value:"ezr", text:"Ezra" },
  { value:"neh", text:"Nehemiah" },
  { value:"est", text:"Esther" },
  { value:"job", text:"Job" },
  { value:"psa", text:"Psalms" },
  { value:"pro", text:"Proverbs" },
  { value:"ecc", text:"Ecclesiastes" },
  { value:"son", text:"Song of Solomon" },
  { value:"isa", text:"Isaiah" },
  { value:"jer", text:"Jeremiah" },
  { value:"lam", text:"Lamentations" },
  { value:"eze", text:"Ezekiel" },
  { value:"dan", text:"Daniel" },
  { value:"hos", text:"Hosea" },
  { value:"joe", text:"Joel" },
  { value:"amo", text:"Amos" },
  { value:"oba", text:"Obadiah" },
  { value:"jon", text:"Jonah" },
  { value:"mic", text:"Micah" },
  { value:"nah", text:"Nahum" },
  { value:"hab", text:"Habakkuk" },
  { value:"zep", text:"Zephaniah" },
  { value:"hag", text:"Haggai" },
  { value:"zec", text:"Zechariah" },
  { value:"mal", text:"Malachi" },
  { value:"mat", text:"Matthew" },
  { value:"mar", text:"Mark" },
  { value:"luk", text:"Luke" },
  { value:"joh", text:"John" },
  { value:"act", text:"Acts" },
  { value:"rom", text:"Romans" },
  { value:"1co", text:"1 Corinthians" },
  { value:"2co", text:"2 Corinthians" },
  { value:"gal", text:"Galatians" },
  { value:"eph", text:"Ephesians" },
  { value:"phi", text:"Philippians" },
  { value:"col", text:"Colossians" },
  { value:"1th", text:"1 Thessalonians" },
  { value:"2th", text:"2 Thessalonians" },
  { value:"1ti", text:"1 Timothy" },
  { value:"2ti", text:"2 Timothy" },
  { value:"tit", text:"Titus" },
  { value:"phile", text:"Philemon" },
  { value:"heb", text:"Hebrews" },
  { value:"jam", text:"James" },
  { value:"1pe", text:"1 Peter" },
  { value:"2pe", text:"2 Peter" },
  { value:"1jo", text:"1 John" },
  { value:"2jo", text:"2 John" },
  { value:"3jo", text:"3 John" },
  { value:"jud", text:"Jude" },
  { value:"rev", text:"Revelation" },
  ];

function parseArgs()
{
  var versionString, dateFormat, verseFont, updateTime, enableLight, btVibe, showAmPm, invertColours, scrollSpeed, favVerseEnable, favVerse;
  var args = location.search.substr(1).split("&");

  for (var i = 0; i<args.length; i++)
  {
      var temp = args[i].split("=");

      if (temp[0] === "versionString")
        versionString = decodeURIComponent(temp[1]);
      else if (temp[0] === "dateFormat")
        dateFormat = decodeURIComponent(temp[1]);
      else if (temp[0] === "verseFont")
        verseFont = decodeURIComponent(temp[1]);
      else if (temp[0] === "updateTime")
        updateTime = decodeURIComponent(temp[1]);
      else if (temp[0] === "enableLight")
        enableLight = decodeURIComponent(temp[1]);
      else if (temp[0] === "btVibe")
        btVibe = decodeURIComponent(temp[1]);
      else if (temp[0] === "showAmPm")
        showAmPm = decodeURIComponent(temp[1]);
      else if (temp[0] === "invertColours")
        invertColours = decodeURIComponent(temp[1]);
      else if (temp[0] === "scrollSpeed")
        scrollSpeed = decodeURIComponent(temp[1]);
      else if (temp[0] === "favVerseEnable")
        favVerseEnable = decodeURIComponent(temp[1]);
      else if (temp[0] === "favVerse")
        favVerse = decodeURIComponent(temp[1]);
  }

  initInputs(versionString, dateFormat, verseFont, updateTime, enableLight, btVibe, showAmPm, invertColours, scrollSpeed, favVerseEnable, favVerse);
}

function initFavVerseCombo(bookVal)
{
  var favVerseBookCombo = document.getElementById("favVerseBook_select");
  
  for (var i=0; i < bookTable.length; i++)
  {
    addOptionToCombo(favVerseBookCombo, bookTable[i]);
  }
  selectComboOption(favVerseBookCombo, bookVal);
}
  
function initInputs(versionString, dateFormat, verseFont, updateTime, enableLight, btVibe, showAmPm, invertColours, scrollSpeed, favVerseEnable, favVerse)
{
  initLanguageAndVersionCombos(versionString);
  initDateFormatCombo(dateFormat);
  
  favVerseObj = unpackFavVerse(""+favVerse);
  initFavVerseCombo(favVerseObj.book);
  
  var updateTimeHourCombo = document.getElementById("updateTimeHour_select");
  var updateTimeMinuteCombo = document.getElementById("updateTimeMinute_select");
  var enableLightCheckbox = document.getElementById("enableLight_checkbox");
  var btVibeCheckbox = document.getElementById("btVibe_checkbox");
  var showAmPmCheckbox = document.getElementById("showAmPm_checkbox");
  var invertColoursCheckbox = document.getElementById("invertColours_checkbox");
  var verseFontCombo = document.getElementById("verseFont_select");
  var scrollSpeedCombo = document.getElementById("scrollSpeed_select");
  var favVerseEnableCheckbox = document.getElementById("favVerseEnable_checkbox");
  var favVerseChapterInput = document.getElementById("favVerseChapter_input");
  var favVerseVerseInput = document.getElementById("favVerseVerse_input");
  
  selectComboOption(verseFontCombo, ""+verseFont);
  selectComboOption(scrollSpeedCombo, ""+scrollSpeed);
  
  var updateTimeVals = translateTimeSetting(updateTime);
  selectComboOption(updateTimeHourCombo, updateTimeVals.hour.toString());
  selectComboOption(updateTimeMinuteCombo, updateTimeVals.minute.toString());

  enableLightCheckbox.checked = (enableLight === 'true');
  btVibeCheckbox.checked = (btVibe === 'true');
  showAmPmCheckbox.checked = (showAmPm === 'true');
  invertColoursCheckbox.checked = (invertColours === 'true');
  favVerseEnableCheckbox.checked = (favVerseEnable === 'true');
  favVerseChapterInput.value = favVerseObj.chapter;
  favVerseVerseInput.value = favVerseObj.verse;
}

function unpackFavVerse(favVerse)
{
  var colonIdx = favVerse.indexOf(':');
  var letters = favVerse.match(/[1-3]?[a-z]*/);
  var chapterStartIdx = favVerse.lastIndexOf(letters[0][letters[0].length-1]) + 1;

  var bookVal = favVerse.substring(0, chapterStartIdx);
  var chapterText = favVerse.substring(chapterStartIdx, colonIdx);
  var verseText = favVerse.slice(colonIdx+1);

  return {book: bookVal, chapter: chapterText, verse: verseText};
}

function initLanguageAndVersionCombos(versionString)
{
  var languageCombo = document.getElementById("language_select");
  var versionCombo = document.getElementById("version_select");
  
  for (var i=0; i<versionTable.length; i++)
  {
    // add option to languageCombo
    addOptionToCombo(languageCombo, versionTable[i].language);

    for (var j=0; j<versionTable[i].versions.length; j++)
    {
      if (versionTable[i].versions[j].value === versionString)
      {
        for (var k=0; k<versionTable[i].versions.length; k++)
          addOptionToCombo(versionCombo, versionTable[i].versions[k]);

        versionCombo.options[j+1].selected = 'selected';
        languageCombo.options[i+1].selected = 'selected';
      }
    }
  }
}

function initDateFormatCombo(dateFormat)
{
  var dateFormatCombo = document.getElementById("dateFormat_select");
  var dateFormats = [10];
  
  var d = new Date();
  var dayNum = d.getDate();
  var dayOfWeekNum = d.getDay();
  var monthNum = d.getMonth();
  var yearNum = d.getFullYear().toString();
  var dayName, monthName;
  
  if (dayNum < 10)
	dayNum = '0' + dayNum.toString();
  else
	dayNum = dayNum.toString();
  
  switch (dayOfWeekNum)
  {
  case 0:  dayName = 'Sunday';  break;
  case 1:  dayName = 'Monday';  break;
  case 2:  dayName = 'Tuesday';  break;
  case 3:  dayName = 'Wednesday';  break;
  case 4:  dayName = 'Thursday';  break;
  case 5:  dayName = 'Friday';  break;
  case 6:  dayName = 'Saturday';  break;
  default:  break;
  }
 
  switch (monthNum)
  {
  case 0:  monthName = 'Jan';  monthNum = '01';  break;
  case 1:  monthName = 'Feb';  monthNum = '02';  break;
  case 2:  monthName = 'Mar';  monthNum = '03';  break;
  case 3:  monthName = 'Apr';  monthNum = '04';  break;
  case 4:  monthName = 'May';  monthNum = '05';  break;
  case 5:  monthName = 'Jun';  monthNum = '06';  break;
  case 6:  monthName = 'Jul';  monthNum = '07';  break;
  case 7:  monthName = 'Aug';  monthNum = '08';  break;
  case 8:  monthName = 'Sep';  monthNum = '09';  break;
  case 9:  monthName = 'Oct';  monthNum = '10';  break;
  case 10:  monthName = 'Nov';  monthNum = '11';  break;
  case 11:  monthName = 'Dec';  monthNum = '12';  break;
  default:  break;
  }
  
  dateFormats[0] = dayName.substring(0,3) + ' ' + dayNum + ' ' + monthName; // Sat 31 Jan
  dateFormats[1] = dayName.substring(0,3) + ' ' + monthName + ' ' + dayNum; // Sat Jan 31
  dateFormats[2] = dayNum + ' ' + monthName; // 31 Jan
  dateFormats[3] = monthName + ' ' + dayNum; // Jan 31
  dateFormats[4] = dayName.substring(0,3) + ' ' + dayNum; // Sat 31
  dateFormats[5] = dayName + ' ' + dayNum; // Saturday 31
  dateFormats[6] = dayNum + '/' + monthNum + '/' + yearNum + ' (DD/MM/YYYY)';
  dateFormats[7] = monthNum + '/' + dayNum + '/' + yearNum + ' (MM/DD/YYYY)';
  dateFormats[8] = dayNum + '/' + monthNum + '/' + yearNum.substring(2,4) + ' (DD/MM/YY)';
  dateFormats[9] = monthNum + '/' + dayNum + '/' + yearNum.substring(2,4) + ' (MM/DD/YY)';
  
  dateFormatCombo.options.remove(0);
  for (var i=0; i<dateFormats.length; i++)
	addOptionToCombo(dateFormatCombo, {value:i, text:dateFormats[i]});
  
  selectComboOption(dateFormatCombo, dateFormat);
}

function selectComboOption(combo, optionValue)
{
  for (var i=0; i<combo.options.length; i++)
  {
    if (combo.options[i].value === optionValue)
      combo.options[i].selected = 'selected';
  }
}

function translateTimeSetting(timeSetting)
{
  var hourVal = Math.floor(timeSetting/60);
  var minuteVal = timeSetting % 60;

  return {hour:hourVal, minute:minuteVal};
}

function setupVersionCombo()
{
  var languageCombo = document.getElementById("language_select");
  var versionCombo = document.getElementById("version_select");
  var language = languageCombo.options[languageCombo.selectedIndex].value;    
  var options = [];
  
  for (var i=0; i<versionTable.length; i++)
  {
    if (versionTable[i].language.value === language)
      options = versionTable[i].versions;
  }
  
  // refresh versionCombo with new options
  for (var j=0, k=1; j<options.length; j++, k++)
  {
    if (k < versionCombo.options.length)
    {
      versionCombo.options[k].value = options[j].value;
      versionCombo.options[k].text = options[j].text;
    }  
    else
      addOptionToCombo(versionCombo, options[j]);
  }

  // remove old options
  for (var l=(versionCombo.options.length-1); l>options.length; l--)
    versionCombo.options.remove(l);

  if (versionCombo.options.length < 3)
    versionCombo.options[1].selected = 'selected';
  else
    versionCombo.options[0].selected = 'selected';
}

function addOptionToCombo(combo, option)
{
  var opt = document.createElement("option");
  opt.value = option.value;
  opt.text = option.text;

  try { combo.add(opt, null); }
  catch(error) { combo.add(opt); }
}

function getVersionString() {
  var versionCombo = document.getElementById("version_select");
  return versionCombo.options[versionCombo.selectedIndex].value;
}

function getDateFormat() {
  var dateFormatCombo = document.getElementById("dateFormat_select");
  return dateFormatCombo.options[dateFormatCombo.selectedIndex].value;
}

function getVerseFont() {
  var verseFontCombo = document.getElementById("verseFont_select");
  return verseFontCombo.options[verseFontCombo.selectedIndex].value;
}

function getScrollSpeed() {
  var scrollSpeedCombo = document.getElementById("scrollSpeed_select");
  return scrollSpeedCombo.options[scrollSpeedCombo.selectedIndex].value;
}

function calcTimeSetting(hourSelect, minuteSelect)
{
  var hourCombo = document.getElementById(hourSelect);
  var minuteCombo = document.getElementById(minuteSelect);

  var hour = hourCombo.options[hourCombo.selectedIndex].value;
  var minute = minuteCombo.options[minuteCombo.selectedIndex].value;

  return (hour*60 + minute*1);
}

function getEnableLight() {
  return document.getElementById("enableLight_checkbox").checked;
}

function getBtVibe() {
  return document.getElementById("btVibe_checkbox").checked;
}

function getShowAmPm() {
  return document.getElementById("showAmPm_checkbox").checked;
}

function getInvertColours() {
  return document.getElementById("invertColours_checkbox").checked;
}

function getUpdateTime() {
  return calcTimeSetting("updateTimeHour_select", "updateTimeMinute_select");
}

function getFavVerseEnable() {
  return document.getElementById("favVerseEnable_checkbox").checked;
}

function getFavVerse() {
  bookVal = document.getElementById("favVerseBook_select").value;
  chapterText = document.getElementById("favVerseChapter_input").value;
  verseText = document.getElementById("favVerseVerse_input").value;
  return bookVal.concat(chapterText, ':', verseText);
}

function validateFavVerse()
{
  chapterText = document.getElementById("favVerseChapter_input").value;
  verseText = document.getElementById("favVerseVerse_input").value;
  if( chapterText.match(/^[1-9]([0-9]?){2}$/) &&
    verseText.match(/^[1-9]([0-9]?){2}(-[1-9]([0-9]?){2})?$/) )
    return true;
  else
    return false;
}

var submitButton = document.getElementById("save_button");
submitButton.addEventListener("click", 
  function() {
    console.log("Settings Page: Submit");
    var options = {
      "versionString": getVersionString(),
      "dateFormat": getDateFormat(),
	  "verseFont": getVerseFont(),
      "updateTime": getUpdateTime(),
      "enableLight": getEnableLight(),
      "btVibe": getBtVibe(),
      "showAmPm": getShowAmPm(),
      "invertColours": getInvertColours(),
      "scrollSpeed": getScrollSpeed(),
	  "favVerseEnable": getFavVerseEnable()
    };
    
    if (getFavVerseEnable() && validateFavVerse())
    {
      options.favVerse = getFavVerse();
    }

    var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(options));
    window.location.href = location;
  }, 
  false);

var cancelButton = document.getElementById("cancel_button");
cancelButton.addEventListener("click", 
  function() {
    console.log("Settings Page: Cancel");
    var location = "pebblejs://close";
    window.location.href = location;
  }, 
  false);
</script>
